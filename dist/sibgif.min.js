!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.SuperGif=e()}}(function(){var e;return function t(e,n,r){function i(o,u){if(!n[o]){if(!e[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){var n=e[o][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){var r=function(e){this.data=e,this.len=this.data.length,this.pos=0,this.readByte=function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return e instanceof Uint8Array?e[this.pos++]:255&e.charCodeAt(this.pos++)},this.readBytes=function(e){for(var t=[],n=0;n<e;n++)t.push(this.readByte());return t},this.read=function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(this.readByte());return t},this.readUnsigned=function(){var e=this.readBytes(2);return(e[1]<<8)+e[0]}};t.exports=r},{}],2:[function(e,t,n){var r=function(e,t){for(var n,r,i=0,a=function(e){for(var n=0,r=0;r<e;r++)t.charCodeAt(i>>3)&1<<(7&i)&&(n|=1<<r),i++;return n},o=[],u=1<<e,s=u+1,l=e+1,c=[],d=function(){c=[],l=e+1;for(var t=0;t<u;t++)c[t]=[t];c[u]=[],c[s]=null};;)if(r=n,n=a(l),n!==u){if(n===s)break;if(n<c.length)r!==u&&c.push(c[r].concat(c[n][0]));else{if(n!==c.length)throw new Error("Invalid LZW code.");c.push(c[r].concat(c[r][0]))}o.push.apply(o,c[n]),c.length===1<<l&&l<12&&l++}else d();return o};t.exports=r},{}],3:[function(e,t,n){var r=function(e){return e.reduce(function(e,t){return 2*e+t},0)},i=function(e){for(var t=[],n=7;n>=0;n--)t.push(!!(e&1<<n));return t},a=e("./lzwDecode.js"),o=function(e,t){t||(t={});var n=function(t){for(var n=[],r=0;r<t;r++)n.push(e.readBytes(3));return n},o=function(){var t,n;n="";do t=e.readByte(),n+=e.read(t);while(0!==t);return n},u=function(){var a={};if(a.sig=e.read(3),a.ver=e.read(3),"GIF"!==a.sig)throw new Error("Not a GIF file.");a.width=e.readUnsigned(),a.height=e.readUnsigned();var o=i(e.readByte());a.gctFlag=o.shift(),a.colorRes=r(o.splice(0,3)),a.sorted=o.shift(),a.gctSize=r(o.splice(0,3)),a.bgColor=e.readByte(),a.pixelAspectRatio=e.readByte(),a.gctFlag&&(a.gct=n(1<<a.gctSize+1)),t.hdr&&t.hdr(a)},s=function(n){var a=function(n){var a=(e.readByte(),i(e.readByte()));n.reserved=a.splice(0,3),n.disposalMethod=r(a.splice(0,3)),n.userInput=a.shift(),n.transparencyGiven=a.shift(),n.delayTime=e.readUnsigned(),n.transparencyIndex=e.readByte(),n.terminator=e.readByte(),t.gce&&t.gce(n)},u=function(e){e.comment=o(),t.com&&t.com(e)},s=function(n){e.readByte();n.ptHeader=e.readBytes(12),n.ptData=o(),t.pte&&t.pte(n)},l=function(n){var r=function(n){e.readByte();n.unknown=e.readByte(),n.iterations=e.readUnsigned(),n.terminator=e.readByte(),t.app&&t.app.NETSCAPE&&t.app.NETSCAPE(n)},i=function(e){e.appData=o(),t.app&&t.app[e.identifier]&&t.app[e.identifier](e)};e.readByte();switch(n.identifier=e.read(8),n.authCode=e.read(3),n.identifier){case"NETSCAPE":r(n);break;default:i(n)}},c=function(e){e.data=o(),t.unknown&&t.unknown(e)};switch(n.label=e.readByte(),n.label){case 249:n.extType="gce",a(n);break;case 254:n.extType="com",u(n);break;case 1:n.extType="pte",s(n);break;case 255:n.extType="app",l(n);break;default:n.extType="unknown",c(n)}},l=function(u){var s=function(e,t){for(var n=new Array(e.length),r=e.length/t,i=function(r,i){var a=e.slice(i*t,(i+1)*t);n.splice.apply(n,[r*t,t].concat(a))},a=[0,4,2,1],o=[8,8,4,2],u=0,s=0;s<4;s++)for(var l=a[s];l<r;l+=o[s])i(l,u),u++;return n};u.leftPos=e.readUnsigned(),u.topPos=e.readUnsigned(),u.width=e.readUnsigned(),u.height=e.readUnsigned();var l=i(e.readByte());u.lctFlag=l.shift(),u.interlaced=l.shift(),u.sorted=l.shift(),u.reserved=l.splice(0,2),u.lctSize=r(l.splice(0,3)),u.lctFlag&&(u.lct=n(1<<u.lctSize+1)),u.lzwMinCodeSize=e.readByte();var c=o();u.pixels=a(u.lzwMinCodeSize,c),u.interlaced&&(u.pixels=s(u.pixels,u.width)),t.img&&t.img(u)},c=function(){var n={};switch(n.sentinel=e.readByte(),String.fromCharCode(n.sentinel)){case"!":n.type="ext",s(n);break;case",":n.type="img",l(n);break;case";":n.type="eof",t.eof&&t.eof(n);break;default:throw new Error("Unknown block: 0x"+n.sentinel.toString(16))}"eof"!==n.type&&setTimeout(c,0)},d=function(){u(),setTimeout(c,0)};d()};t.exports=o},{"./lzwDecode.js":2}],4:[function(t,n,r){!function(t,i){"function"==typeof e&&e.amd?e([],i):"object"==typeof r?n.exports=i():t.SuperGif=i()}(this,function(){if("object"==typeof r)var e=t("./Stream.js"),n=t("./parseGIF.js");var i=function(t){var r={vp_l:0,vp_t:0,vp_w:null,vp_h:null,c_w:null,c_h:null};for(var i in t)r[i]=t[i];r.vp_w&&r.vp_h&&(r.is_vp=!0);var a,o,u=null,s=!1,l=null,c=null,d=null,f=null,h=null,p=null,g=null,y=!0,v=!0,_=!1,w=[],m=[],x=r.gif;"undefined"==typeof r.auto_play&&(r.auto_play=!x.getAttribute("data-autoplay")||"1"==x.getAttribute("data-autoplay"));var b,T,B,C,S=r.hasOwnProperty("on_end")?r.on_end:null,P=r.hasOwnProperty("loop_delay")?r.loop_delay:0,k=r.hasOwnProperty("loop_mode")?r.loop_mode:"auto",E=!r.hasOwnProperty("draw_while_loading")||r.draw_while_loading,A=!!E&&(!r.hasOwnProperty("show_progress_bar")||r.show_progress_bar),U=r.hasOwnProperty("progressbar_height")?r.progressbar_height:25,I=r.hasOwnProperty("progressbar_background_color")?r.progressbar_background_color:"rgba(255,255,255,0.4)",D=r.hasOwnProperty("progressbar_foreground_color")?r.progressbar_foreground_color:"rgba(255,0,22,.8)",O=function(){l=null,c=null,h=d,d=null,p=null},j=function(){return{hdr:Z(M),gce:Z(q),com:Z(X),app:{NETSCAPE:Z(X)},img:Z(W,!0),eof:function(e){L(),V(!1),r.c_w&&r.c_h||(b.width=o.width*K(),b.height=o.height*K()),H.init(),s=!1,Y&&Y(u,x)}}},R=function(){try{n(a,j())}catch(e){G("parse")}},z=function(e,t){b.width=e*K(),b.height=t*K(),B.style.minWidth=e*K()+"px",C.width=e,C.height=t,C.style.width=e+"px",C.style.height=t+"px",C.getContext("2d").setTransform(1,0,0,1,0,0)},F=function(e,t){return m[e]?("undefined"!=typeof t.x&&(m[e].x=t.x),void("undefined"!=typeof t.y&&(m[e].y=t.y))):void(m[e]=t)},N=function(e,t,n){if(n&&A){var i,a,o,u,s=U;r.is_vp?_?(o=(r.vp_t+r.vp_h-s)/K(),s/=K(),i=r.vp_l/K(),a=i+e/t*(r.vp_w/K()),u=b.width/K()):(o=r.vp_t+r.vp_h-s,s=s,i=r.vp_l,a=i+e/t*r.vp_w,u=b.width):(o=(b.height-s)/(_?K():1),a=e/t*b.width/(_?K():1),u=b.width/(_?K():1),s/=_?K():1),T.fillStyle=I,T.fillRect(a,o,u-a,s),T.fillStyle=D,T.fillRect(0,o,a,s)}},G=function(e){var t=function(){T.fillStyle="black",T.fillRect(0,0,r.c_w?r.c_w:o.width,r.c_h?r.c_h:o.height),T.strokeStyle="red",T.lineWidth=3,T.moveTo(0,0),T.lineTo(r.c_w?r.c_w:o.width,r.c_h?r.c_h:o.height),T.moveTo(0,r.c_h?r.c_h:o.height),T.lineTo(r.c_w?r.c_w:o.width,0),T.stroke()};u=e,o={width:x.width,height:x.height},w=[],t()},M=function(e){o=e,z(o.width,o.height)},q=function(e){L(),O(),l=e.transparencyGiven?e.transparencyIndex:null,c=e.delayTime,d=e.disposalMethod},L=function(){if(p){var e={data:p.getImageData(0,0,o.width,o.height),delay:c};r.includeDataURL&&(e.dataURL=C.toDataURL()),w.push(e),m.push({x:0,y:0})}},W=function(e){p||(p=C.getContext("2d"));var t=w.length,n=e.lctFlag?e.lct:o.gct;t>0&&(3===h?null!==f?p.putImageData(w[f].data,0,0):p.clearRect(g.leftPos,g.topPos,g.width,g.height):f=t-1,2===h&&p.clearRect(g.leftPos,g.topPos,g.width,g.height));var i=p.getImageData(e.leftPos,e.topPos,e.width,e.height);e.pixels.forEach(function(e,t){e!==l&&(i.data[4*t+0]=n[e][0],i.data[4*t+1]=n[e][1],i.data[4*t+2]=n[e][2],i.data[4*t+3]=255)}),p.putImageData(i,e.leftPos,e.topPos),_||(T.scale(K(),K()),_=!0),E&&(T.drawImage(C,0,0),E=r.auto_play),g=e},H=function(){var e=-1,t=0,n=function(){var t=v?1:-1;return(e+t+w.length)%w.length},i=function(t){e+=t,o()},a=function(){var r=!1,a=function(){null!==S&&S(x),t++,k!==!1||t<0?o():(r=!1,y=!1)},o=function(){if(r=y){i(1);var t=10*w[e].delay;t||(t=100);var u=n();0===u?(t+=P,setTimeout(a,t)):setTimeout(o,t)}};return function(){r||setTimeout(o,0)}}(),o=function(){var t;e=parseInt(e,10),e>w.length-1&&(e=0),e<0&&(e=0),t=m[e],C.getContext("2d").putImageData(w[e].data,t.x,t.y),T.globalCompositeOperation="copy",T.drawImage(C,0,0)},s=function(){y=!0,a()},l=function(){y=!1};return{init:function(){u||(r.c_w&&r.c_h||T.scale(K(),K()),r.auto_play?a():(e=0,o()))},step:a,play:s,pause:l,playing:y,move_relative:i,current_frame:function(){return e},frames:function(){return w},length:function(){return w.length},move_to:function(t){e=t,o()}}}(),V=function(e){N(a.pos,a.data.length,e)},X=function(){},Z=function(e,t){return function(n){e(n),V(t)}},J=function(){var e=x.parentNode,t=document.createElement("div");b=document.createElement("canvas"),T=b.getContext("2d"),B=document.createElement("div"),C=document.createElement("canvas"),t.width=b.width=x.width,t.height=b.height=x.height,B.style.minWidth=x.width+"px",t.className="jsgif",B.className="jsgif_toolbar",t.appendChild(b),t.appendChild(B),e.insertBefore(t,x),e.removeChild(x),r.c_w&&r.c_h&&z(r.c_w,r.c_h),Q=!0},K=function(){var e;return e=r.max_width&&o&&o.width>r.max_width?r.max_width/o.width:1},Q=!1,Y=!1,$=function(e){return!s&&(Y=!!e&&e,s=!0,w=[],O(),f=null,h=null,p=null,g=null,!0)};return{play:H.play,pause:H.pause,move_relative:H.move_relative,move_to:H.move_to,get_frames:function(){return H.frames()},get_playing:function(){return y},get_canvas:function(){return b},get_canvas_scale:function(){return K()},get_loading:function(){return s},get_auto_play:function(){return r.auto_play},get_length:function(){return H.length()},get_current_frame:function(){return H.current_frame()},load_url:function(t,n){if($(n)){var r=new XMLHttpRequest;r.open("GET",t,!0),"overrideMimeType"in r?r.overrideMimeType("text/plain; charset=x-user-defined"):"responseType"in r?r.responseType="arraybuffer":r.setRequestHeader("Accept-Charset","x-user-defined"),r.onloadstart=function(){Q||J()},r.onload=function(t){200!=this.status&&G("xhr - response"),"response"in this||(this.response=new VBArray(this.responseText).toArray().map(String.fromCharCode).join(""));var n=this.response;n.toString().indexOf("ArrayBuffer")>0&&(n=new Uint8Array(n)),a=new e(n),setTimeout(R,0)},r.onprogress=function(e){e.lengthComputable&&N(e.loaded,e.total,!0)},r.onerror=function(){G("xhr")},r.send()}},load:function(e){this.load_url(x.getAttribute("data-animated-src")||x.src,e)},load_raw:function(t,n){$(n)&&(Q||J(),a=new e(t),setTimeout(R,0))},set_frame_offset:F}};return i})},{"./Stream.js":1,"./parseGIF.js":3}]},{},[4])(4)});
//# sourceMappingURL=sibgif.min.js.map
